import{r as n,j as e,A as w,m as y,e as N,a as g,f as E}from"./index-B6qwpcLu.js";const S=s=>n.createElement("svg",{viewBox:"0 0 32 35",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...s},n.createElement("path",{d:"M32 6V35H0V6C0 3 3 0 6 0H26C29 0 32 3 32 6ZM4 27.5V33H28V27.5H26V31H6V27.5H4Z"}));function b(s){return s?/^\+?\d{10,14}$/.test(s):!0}function L(s){return s?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s):!0}function f(s,r,C){return L(r)&&b(C)&&s.length>0&&r.length>0}function k({className:s,setVisability:r,setPassengers:C,seatNumber:p}){n.useEffect(()=>{const o=c=>{c.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}});const[i,x]=n.useState(""),[u,l]=n.useState(""),[a,m]=n.useState("");return e.jsxs("div",{onClick:o=>{o.stopPropagation()},className:`bg-(--pale-accent) p-4 rounded-md shadow-lg${s} h-auto`,children:[e.jsxs("div",{className:"flex gap-2 items-center justify-between",children:[e.jsx("h2",{className:"text-lg p-1 font-extralight",children:"Seat number:"}),e.jsx("div",{className:"text-2xl text-bold p-1 rounded-sm text-(--accent) font-bold",children:p})]}),e.jsx("div",{className:"w-full h-[1px] bg-(--accent) my-4"}),e.jsx("div",{className:"text-lg text-center mb-2",children:"Enter passenger details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("label",{children:["Name:",e.jsx("input",{type:"text",value:i,onChange:o=>x(o.target.value),className:"border-2 border-(--accent) bg-slate-50 rounded-md p-2 w-full"})]}),e.jsxs("label",{children:["Email:",e.jsx("input",{type:"text",value:u,onChange:o=>l(o.target.value),className:L(u)?"border-2 border-(--accent) bg-slate-50  rounded-md p-2 w-full":"border-2 bg-slate-50 border-red-500 rounded-md p-2 w-full"})]}),e.jsxs("label",{children:["Phone:",e.jsx("input",{type:"text",value:a,onChange:o=>m(o.target.value),className:b(a)?"border-2 border-(--accent) bg-slate-50  rounded-md p-2 w-full":"border-2 bg-slate-50 border-red-500 rounded-md p-2 w-full"})]}),e.jsx(w,{className:f(i,u,a)?"bg-(--accent) text-white hover:bg-(--primary) rounded-md p-2 mt-4":" bg-zinc-400 text-white hover:bg-zinc-400 rounded-md p-2 mt-4",onClick:o=>{if(o.preventDefault(),f(i,u,a)){const c={name:i,email:u,phone:a,seat:p||""};C&&C(t=>[...t,c]),x(""),l(""),m(""),r(!1)}else alert("Please enter valid email and phone number")},children:"Save"})]})]})}function P({seatMap:s,className:r,setPassengers:C}){const[p,i]=n.useState(!1),[x,u]=n.useState(null),l=Array(29).fill(0).map((a,m)=>m+1);return l.splice(12,0,-1),l.splice(16,0,-2),e.jsxs("div",{className:`${r} grid grid-cols-[repeat(7, auto)] grid-rows-[min-content_50px_min-content] gap-y-5 gap-x-2`,children:[e.jsx(y.div,{className:"fixed inset-0 z-10 bg-black/50 flex items-center justify-center",animate:p?{opacity:1}:{opacity:0,display:"none"},initial:{opacity:0},exit:{opacity:0,display:"none"},transition:{duration:.2},onClick:a=>{a.stopPropagation(),i(!1)},children:e.jsx(k,{setVisability:i,seatNumber:x,className:"w-[600px] h-[500px]",setPassengers:C})}),e.jsx("div",{className:"col-start-4 row-start-1 row-span-50 w-full grid grid-rows-[min-content_50px] auto-rows-min gap-y-5",children:l.map(a=>e.jsx("div",{className:"h-10 w-full flex items-center justify-center text-(--accent) font-bold",children:a>0?a:null},a))}),e.jsx("div",{className:"col-start-1 row-start-1 row-span-2"}),e.jsx("div",{className:"col-start-7 row-start-1 row-span-2"}),e.jsx(v,{className:"row-start-13"}),e.jsx(v,{className:"row-start-17"}),s.map(a=>e.jsx($,{id:a.id,booked:a.booked,setIsPopupOpen:i,setSelectedSeat:u,selectedSeat:x},a.id))]})}function $({id:s,booked:r,setIsPopupOpen:C,setSelectedSeat:p,selectedSeat:i}){return e.jsx(S,{onClick:()=>{p(s),C(!0)},className:`${i===s?"text-sky-500":""} ${r?"text-gray-400 pointer-events-none":"text-green-600"} hover:text-green-500 hover:shadow-green-500 w-8 h-10 rounded cursor-pointer`})}function v({className:s}){return e.jsx("div",{className:`relative ${s} col-start-1 col-span-7 h-10`,children:e.jsxs("div",{className:"absolute -left-4 -right-4 flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 font-bold text-(--accent)",children:[e.jsx("div",{className:"h-10 w-1 bg-(--accent) rounded-sm"}),e.jsx("div",{children:"Exit"})]}),e.jsxs("div",{className:"flex items-center gap-4 font-bold text-(--accent)",children:[e.jsx("div",{children:"Exit"}),e.jsx("div",{className:"h-10 w-1 bg-(--accent) rounded-sm"})]})]})})}const D=s=>n.createElement("svg",{viewBox:"0 0 1300 1435",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},n.createElement("path",{d:"M596.623 78.1526C617.81 25.6264 630.498 5.55346 645.382 1.00883C650.767 -0.635181 657.467 1.23021 663.475 6.04642C667.288 9.10298 673.456 16.8587 678.289 24.6719C688.029 40.4189 704.981 78.1003 711.212 97.8571C712.442 101.755 713.732 104.769 714.08 104.553C714.432 104.336 714.507 102.349 714.248 100.064C713.869 96.709 713.969 95.9656 714.804 95.9656C716.011 95.9656 717.068 99.21 718.154 106.246C718.898 111.071 718.862 111.411 717.435 112.931L715.932 114.531L718.047 125.166C720.689 138.444 722.599 151.863 723.95 166.63C724.525 172.917 725.19 179.619 725.428 181.525C725.665 183.43 726.101 242.039 726.396 311.768C726.768 399.578 727.17 439.931 727.705 443.05C728.13 445.527 728.959 455.258 729.548 464.674C730.696 483.027 731.738 488.384 735.028 492.843C737.527 496.231 732.149 493.3 794.321 525.161C809.752 533.068 822.993 539.963 823.744 540.481C824.495 541.001 825.69 541.426 826.397 541.426C827.432 541.426 827.608 541.054 827.294 539.52C826.241 534.361 825.272 523.642 824.555 509.211L823.763 493.277L821.858 493.058L819.953 492.839L819.957 486.477C819.961 479.075 820.732 475.746 823.089 472.944C824.57 471.183 824.88 469.837 825.524 462.358C826.857 446.862 829.875 436.592 833.339 435.762C841.504 433.809 875.085 432.728 889.573 433.953L898.579 434.714L900.734 437.155C905.029 442.017 906.751 451.904 909.306 486.349C910.617 504.034 908.292 532.326 903.34 558.943C902.078 565.726 901.877 565.948 896.328 566.698C894.328 566.967 892.571 567.393 892.424 567.643C892.277 567.893 891.947 569.657 891.692 571.562L891.229 575.026L900.446 579.676C905.515 582.233 915.741 587.478 923.171 591.332C930.601 595.187 949.461 604.901 965.082 612.92C980.703 620.938 1000.81 631.313 1009.76 635.975C1018.72 640.637 1035.71 649.369 1047.52 655.38C1059.33 661.389 1072.11 667.939 1075.92 669.934C1079.73 671.93 1092.2 678.32 1103.63 684.135C1115.06 689.95 1127.22 696.185 1130.65 697.989C1136.43 701.032 1143.93 704.887 1181.56 724.152C1189.37 728.15 1200.44 733.838 1206.16 736.791C1211.87 739.744 1221.38 744.647 1227.28 747.687C1233.19 750.727 1246.09 757.369 1255.96 762.448C1270.28 769.824 1274.72 772.448 1278.01 775.49C1287.83 784.589 1294.89 798.861 1297.6 815.094C1298.44 820.182 1299.82 843.51 1300 855.776C1300.02 856.88 1299.62 857.335 1298.64 857.335C1297.47 857.335 1297.25 856.872 1297.25 854.391C1297.24 852.771 1297.05 849.374 1296.81 846.841L1296.37 842.237L1290.4 840.516C1278.89 837.197 1190.78 811.611 1178.1 807.905C1137.9 796.158 1114.55 789.442 1113.89 789.442C1112.3 789.442 1111.58 791.562 1110.92 798.166C1109.97 807.715 1108.08 818.353 1107.09 819.707C1104.41 823.368 1102.06 814.495 1100.63 795.302C1100.01 786.921 1098.84 784.467 1095.07 783.584C1093.08 783.118 1084.09 780.52 1056.87 772.538C1047.15 769.69 1033.28 765.646 1026.04 763.552C1018.8 761.458 1005.71 757.657 996.949 755.105C975.776 748.939 973.151 748.231 972.8 748.601C972.635 748.773 971.99 752.425 971.364 756.716C969.859 767.045 967.828 773.669 966.254 773.375C964.468 773.041 962.716 766.846 961.014 754.856L959.497 744.172L929.039 735.319C912.286 730.45 897.004 725.974 895.08 725.372C892.459 724.553 889.269 724.328 882.366 724.473L873.151 724.667L871.555 730.984C869.873 737.648 868.175 741.64 867.027 741.64C866.028 741.64 865.026 739.125 862.967 731.454L861.147 724.667L851.669 724.474L842.191 724.282L841.88 726.553C839.831 741.539 837.783 749.898 836.018 750.487C834.191 751.096 831.387 741.297 829.819 728.823L829.297 724.667L777.865 724.49L726.433 724.312L726.432 888.679C726.432 1061.96 726.478 1058.95 723.315 1090.8C719.93 1124.89 712.53 1171.8 705.172 1205.81C702.873 1216.43 702.753 1217.56 703.474 1221.88C704.561 1228.39 707.329 1233.76 712.329 1239.06C715.738 1242.67 745.941 1261.25 756.975 1268.01C757.566 1267.9 776.451 1280.2 785.374 1285.69C808.244 1299.74 845.861 1322.74 864.635 1334.16C885.823 1347.04 886.116 1347.33 888.641 1358.09C889.811 1363.07 890.116 1367.31 890.415 1382.73L890.776 1401.36L889.136 1400.96C888.234 1400.74 868.324 1396.32 844.892 1391.15C821.46 1385.97 792.625 1379.57 780.813 1376.92C769.002 1374.27 742.44 1368.37 721.787 1363.8C701.133 1359.23 683.498 1355.3 682.597 1355.08C680.98 1354.67 680.928 1354.83 678.365 1368.05C671.917 1401.3 664.588 1426.27 659.503 1432.31L657.729 1434.42H650.197C643.298 1434.42 642.545 1434.29 641.226 1432.88C636.101 1427.38 628.837 1403.16 622.467 1370.34C620.84 1361.96 619.469 1355.03 619.421 1354.95C619.374 1354.87 606.881 1357.56 591.66 1360.94C576.438 1364.32 556.815 1368.68 548.052 1370.62C539.289 1372.56 528.69 1374.92 524.499 1375.86C520.308 1376.8 493.499 1382.74 464.924 1389.06C436.348 1395.37 412.24 1400.72 411.349 1400.95L409.731 1401.35L410.016 1382.73C410.386 1358.56 411.807 1351.48 417.378 1346.06C418.532 1344.93 428.299 1338.65 439.083 1332.08C449.866 1325.52 461.65 1318.34 465.27 1316.12C468.889 1313.9 481.982 1305.9 494.365 1298.35C506.748 1290.79 517.97 1283.91 519.304 1283.06C523.367 1280.48 529.94 1276.46 548.745 1265.08C558.652 1259.09 567.536 1253.65 568.488 1253C569.441 1252.35 573.269 1249.99 576.996 1247.76C588.418 1240.91 595.158 1232.19 596.962 1221.95C597.621 1218.21 597.454 1216.67 595.268 1206.43C588.127 1172.97 581.78 1133.8 577.879 1099.12C574.23 1066.67 574.464 1079.16 574.06 895.438L573.684 724.667L522.303 724.489L470.923 724.311L470.455 728.993C469.393 739.644 466.442 750.3 464.555 750.3C463.015 750.3 460.449 741.803 459.168 732.461L458.051 724.32H448.886C443.355 724.32 439.545 724.603 439.28 725.033C439.038 725.425 437.954 729.047 436.871 733.082C434.738 741.033 434.029 742.33 432.505 741.065C431.659 740.361 428.67 731.408 427.553 726.226L427.143 724.32L417.977 724.33L408.811 724.34L374.877 734.257C335.834 745.668 340.594 742.878 339.233 755.15C338.81 758.96 337.808 764.519 337.005 767.503C335.615 772.669 334.31 774.447 332.926 773.063C331.985 772.121 329.62 762.183 328.746 755.496C327.678 747.318 327.973 747.776 324.503 748.908C322.866 749.442 300.051 756.118 300.051 756.118L280.904 761.68C271.798 764.325 261.632 767.279 255.715 768.997C233.342 775.497 216.055 780.555 206.704 783.337C204.053 784.125 202.028 785.116 202.028 785.625C202.028 786.119 201.607 786.685 201.091 786.882C200.425 787.138 200.013 789.471 199.666 794.958C199.12 803.599 197.548 814.952 196.426 818.366C195.593 820.898 194.124 821.289 193.041 819.267C192.152 817.604 189.871 804.206 189.212 796.77C188.546 789.255 188.064 788.86 181.717 790.644C174.53 792.664 120.068 808.442 95.3459 815.667C83.7252 819.063 67.5149 823.782 59.3232 826.155C22.9786 836.68 4.26361 842.196 4.00036 842.459C3.58607 842.874 3.39901 845.227 3.29991 851.295C3.22999 855.543 2.97639 856.776 2.10217 857.111C1.01529 857.528 -0.440897 856.122 0.127158 855.202C0.285794 854.946 0.714586 846.982 1.08101 837.504C2.28912 806.243 7.00052 791.553 20.2741 777.659C25.9054 771.764 24.4896 772.583 65.2117 751.677C72.4509 747.961 83.6732 742.195 90.1504 738.864C96.6275 735.533 108.162 729.609 115.782 725.699C123.402 721.789 134.624 716.023 140.721 712.885C146.817 709.748 159.286 703.356 168.43 698.681C177.574 694.006 193.629 685.749 204.106 680.331C214.584 674.913 233.444 665.25 246.017 658.858C258.59 652.466 269.813 646.697 270.956 646.037C272.099 645.378 280.827 640.86 290.352 635.998C299.878 631.135 311.1 625.367 315.291 623.177C319.482 620.988 330.081 615.532 338.845 611.051C365.268 597.54 408.793 575.154 409.084 574.925C409.234 574.806 409.079 573.068 408.738 571.061L408.118 567.412L403.738 566.63C401.328 566.2 399.106 565.575 398.8 565.241C398.135 564.518 395.109 548.337 393.633 537.615C390.693 516.264 390.054 499.793 391.441 481.153C393.741 450.234 395.326 441.795 399.727 437.02C401.845 434.721 402.028 434.667 409.85 434.027C425.291 432.762 453.787 433.44 464.902 435.337C470.223 436.246 473.133 443.669 474.417 459.608C475.131 468.472 475.436 469.997 476.89 471.943C479.363 475.254 480.51 479.962 480.51 486.806V492.931H478.505H476.501L476.059 504.535C475.656 515.088 474.16 532.846 473.103 539.614L472.683 542.307L489.931 533.458C499.418 528.592 510.921 522.667 515.494 520.295C520.066 517.922 532.223 511.684 542.51 506.434C552.797 501.184 562.1 496.075 563.184 495.082C565.644 492.827 568.061 488.104 569.071 483.578C569.496 481.673 570.343 472.32 570.952 462.794C571.56 453.269 572.392 443.76 572.8 441.665C573.3 439.096 573.691 396.663 573.997 311.421C574.399 199.553 574.587 183.631 575.633 173.211C577.813 151.472 579.554 139.381 582.794 123.47L584.6 114.604L583.111 113.019C581.725 111.543 581.67 111.101 582.311 106.581C583.173 100.499 584.478 96.5125 585.742 96.0976C586.539 95.8358 586.636 96.5465 586.276 99.9959C586.033 102.316 586.115 104.388 586.458 104.6C586.8 104.811 588.046 101.875 589.227 98.0761C590.407 94.2769 593.735 85.3111 596.623 78.1526Z",fill:"#D9D9D9"})),R=function(){const[r,C]=n.useState(null),[p,i]=n.useState(!0),[x,u]=n.useState(),l=N(),[a,m]=n.useState([]);if(n.useEffect(()=>{(async()=>{try{const t=await g.get("/api/booking/session");t.data&&Object.keys(t.data).length>0?(console.log("Existing session found via GET:",t.data),u(t.data.currentBooking)):(console.log("GET /api/booking/session returned empty or invalid data."),l({to:"/"}))}catch(t){t instanceof Error?console.error("Error checking session via GET:",t.message):console.error("An unexpected error occurred:",t),l({to:"/"})}})()},[l]),console.log(x),n.useEffect(()=>{let c=!0;return(async()=>{i(!0);try{const d=await g.get("/api/booking/seats");if(d.status!==200)throw new Error(`Error fetching seat data: ${d.status}`);if(!c)return;console.log("Seat data fetched successfully:",d.data);const j=d.data.seats.map(h=>({id:h.seat_number,booked:h.status}));C(j)}catch(d){if(!c)return;console.error("Error fetching seat data:",d)}c&&i(!1)})(),()=>{c=!1}},[]),p)return e.jsx("div",{children:"Loading seat map..."});const o=async c=>{try{const t=await g.post("/api/booking/seats",{passengers:c});t.status>=200&&t.status<300?l({to:"/booking/extras"}):alert(`Failed to save search details. Server responded with status: ${t.status}`)}catch(t){console.error("Error saving session data via POST:",t);let d="An error occurred while saving search details.";console.log(d),t instanceof E&&t.response?.data?.error?d=`Error: ${t.response.data.error}`:t instanceof Error&&(d=`Error: ${t.message}`)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"h-550 flex justify-center relative overflow-hidden",children:[e.jsx(D,{className:"absolute h-800 -z-1 -top-70"}),r?e.jsx(P,{seatMap:r,className:"mt-40",passengers:a,setPassengers:m}):e.jsx("div",{children:"No seat data available."})]}),e.jsx("div",{className:"fixed bottom-12 right-12 z-1",children:a.length>0&&e.jsx(w,{hoverOverlayTheme:"light",className:"px-6 w-[120px] h-12",onClick:()=>{o(a)},children:"Continue"})})]})};export{R as component};
